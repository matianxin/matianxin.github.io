---
title: 虚拟化隔离安装配置说明
tags: [eletric power]
categories: Eletric Power
description: 实验室全虚拟化场景中隔离的具体配置
date: 2019/6/21 20:00:00
---

## 虚拟化隔离安装配置说明

创建纵向隔离组件[反向隔离] SW。
创建主机组件[win7] PC。
SW与PC通过串口线连接。

<!-- more -->

### 配置管理工具。
打开QT界面隔离管理工具。
- 前提：windows虚拟机已经安装vc_redist.2015.x64
 - 且QT管理工具中包含vcruntime140.dll，libcrypto-1_1.dll。
- 用户名：admin 密码：111111
- 串口登录。 串口：COM1。 频率：115200。 √ 反向隔离。

### 设备配置 -> 基本配置
- 管理IP：     无     -> 不填
- 设备名称：   dev     -> 自定义
- ETH0协商IP： 192.168.1.100  -> 与发送端须配置成相同网段
- ETH1协商IP： 0.0.0.0        -> 可不做配置

### 规则配置 -> 主机信息1 -> 添加
- √ IP和MAC地址绑定
- 主机名：   sender            -> 自定义
- MAC1：    FA:16:3E:40:11:01 -> 主机网卡MAC地址
- 主机IP：   192.168.1.10      -> 主机网卡ip地址
- 主机虚拟IP1：ETH0协商IP与主机同网段时自动生成,不通网段时填写一个ETH0所在网段下任意IP地址
- 主机虚拟ip2：可以不填

### 规则配置 -> 主机信息2 -> 添加
- √ IP和MAC地址绑定
- 主机名：   receiver          -> 自定义
- MAC1：    FA:16:3E:40:11:02 -> 主机网卡MAC地址
- 主机IP：   192.168.1.20      -> 主机网卡ip地址
- 主机虚拟IP1：ETH0协商IP与主机同网段时自动生成,不通网段时填写一个ETH0所在网段下任意IP地址
- 主机虚拟ip2：可以不填

### 规则配置 -> 连接信息
- 规则名：       rule         -> 自定义
- (内网)IP地址： 192.100.1.10
- (内网)虚拟IP： 192.100.1.10
- (内网)网口号： ETH0/网口0
- (外网)IP地址： 192.100.1.20
- (外网)虚拟IP： 192.100.1.20
- (外网)网口号： ETH0/网口0
- 协议：        UDP（反向）   TCP正向

### 证书互导
- 设备密钥 √ RSA -> 导出设备证书文件 -> dev.cer
- 发送端证书 -> 添加
 - 发送端IP： 192.168.1.14 -> 此处为发送端IP，不为虚拟IP
 - 证书标识： sender.cer

> 管理工具配置好隔离之后，正反向隔离需重启生效。
> 主机信息位置：/etc/mac.conf
> 连接信息位置：/etc/rules

### 传输软件配置
- 检查config目录下是否有**.p12文件，若存在，则删除。
- 启动传输软件。 Stonewall-2000-Send.jar
- 右键 -> 以管理员身份运行 -> 命令行 ->
```java
java -jar Stonewall-2000-Send.jar
设置密码口令保护窗口如果报错，需先运行jreUpdate1.8.jar
```
- 出现提示：系统检测到密钥尚未存在，是否需要生成密钥？ -> 是
- 创建登录口令：123456。 确定，提示操作成功。
- 登录窗口：
 - 操作员名称： administrator
 - 操作员密码： 12345678
 - 密钥保护口令： 123456
-
- 管理 -> 密钥管理 -> 导出密钥。 -> sender.cer
- 设定 -> 配置加密隧道
 - 隧道名称： Tunnel-1
 - 隧道的协商IP地址： 192.168.1.100  -> 设备ETH0协商IP
 - 隧道的协商端口：   4558
 - 隧道每次通过的文件数： 100
 - 隔离设备证书路径： ../.. dev.cer
- 设定 -> 配置链路信息
 - 链路名称： Link-1
 - 目的IP地址： 192.168.1.13  -> 接收端IP地址，正反向隔离在相同环境的情况下，配置虚拟IP。
 - 目的端口：   7777
 - 发送失败等待周期(秒)： 30
 - 使用隧道：   Tunnel-1
